
<h1 class="text-center my-4">My Kitchens</h1>

<div class="container">
  <div class="row">
    <% @kitchens.each do |kitchen| %>
      <div class="col-sm-6 col-md-4 col-lg-3 mb-4 d-flex">
        <div class="card card-product w-100 rounded">
         <% if kitchen.photos.attached? && kitchen.photos.any? %>
           <%= cl_image_tag kitchen.photos.first.key, class: "img-fluid rounded-top", alt: "Kitchen Image" %>
          <% else %>
           <%= image_tag 'placeholder.jpeg', alt: kitchen.name, class: 'img-fluid rounded-top' %>
         <% end %>
          <div class="card-body card-product-infos d-flex flex-column">
            <h5 class="card-title"><%= kitchen.name %></h5>
            <p class="card-text"><%= kitchen.address %></p>
            <p class="card-text"><%= kitchen.description %></p>
            <p class="card-text"><%= "#{number_to_currency(kitchen.daily_rate)}/day" %></p>
            <%= link_to 'Show', kitchen, class: 'btn btn-primary btn-sm mt-auto btn-block' %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

<h1 class="text-center my-4">Incoming Requests</h1>

<%# RESERVATIONS %>


<div class="container">
  <table class="table table-striped">
    <thead class="thead-dark">
      <tr>
        <th scope="col">Name</th>
        <th scope="col">Kitchen</th>
        <th scope="col">Start Date</th>
        <th scope="col">End Date</th>
        <th scope="col">Total Price</th>
        <th scope="col">Accepted/Declined</th>
      </tr>
    </thead>
    <tbody>
      <% @kitchens.each do |kitchen| %>
	      <% kitchen.reservations.each do |reservation| %>
        <%# <%= reservation.user %>
        <div>
          <tr>
            <td><%= "#{reservation.user.first_name} #{reservation.user.last_name}" %></td>
            <td><%= reservation.kitchen.name %></td>
            <td><%= reservation.start_date.strftime("%B %d, %Y") %></td>
            <td><%= reservation.end_date.strftime("%B %d, %Y") %></td>
            <td><%= reservation.total_price %></td>
            <td><%= reservation.status %></td>
            <td>
              <% is_disabled = reservation.status == 'pending' ? "" : "disabled" %>
              <%= button_to 'Accept', reservation_path(reservation, reservation: {status: 'Accepted'}), method: :patch, class: "#{is_disabled} btn btn-primary btn-sm"%>
              <%= button_to 'Decline', reservation_path(reservation, reservation: {status: 'Declined'}), method: :patch, class: "#{is_disabled} btn btn-danger btn-sm" %>
            </td>
          </tr>
        </div>
	      <% end %>
      <% end %>
    </tbody>
  </table>
</div>


<%# iterate on each kitchen @kitchens each do
then .reservations and iterate on that array kitchen.reservations.each do %>
